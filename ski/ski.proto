// See plan-protobuf/README.md

syntax = "proto3";

package ski;


enum KeyType {
    NOT_SET             = 0;

    SYMMETRIC_KEY       = 1;
    ASYMMETRIC_KEY      = 2;
    SIGNING_KEY         = 3;
}


enum KeyDomain {

    // Keys shared with all other community members
    COMMUNITY           = 0;

    // Keys explicitly shared with select community members (e.g. private channel keys)
    PEERS               = 1;

    // Private keyring -- should never be shared with others, even peers in the community.
    PERSONAL            = 2;

}

enum  CryptoKitID {
    INVALID_KIT_ID      = 0;

    NaCl                = 1;
}




message KeyEntry {
    
    // Specifies what type of KeyType this is
                KeyType         key_type                = 1;

    // Specifies which domaon/area this key is used in
                KeyDomain       key_domain              = 2;

    // Specifies which CryptoKit handles this key's ops
                CryptoKitID     crypto_kit_id           = 3;

    // Unix timestamp when this key was created
                int64           time_created            = 4;

    // Private part of the key -- should be used and copied carefully.
                bytes           priv_key                = 5;

    // Public part of the key; how this key is also referenced publicly.
                bytes           pub_key                 = 6;
}





// KeyBundle is a set of KeyEntries grouped by KeyDomain.
// When a KeyBundle is serialized, it's identified by the codec name ski.KeyBundleProtobufCodec
message KeyBundle {

    // The community associated with the keys in this bundle
                bytes           community_id            = 1;

    // Key storage
    repeated    KeyEntry        keys                    = 2;
}




// KeySpec effectively names/specifies a key (within a given community keyring)
message KeySpec {

    // Which key domain does this key live in?
                KeyDomain       key_domain              = 1;

    // Optional -- the type of the key (or NOT_SET)
                KeyType         key_type                = 2;

    // KeyEntry.PubKey
                bytes           pub_key                 = 3;
}


// KeySpecs is a list of KeySpec and when serialized is identified by the codec name ski.KeySpecsProtobufCodec
message KeySpecs {

    repeated    KeySpec         specs                   = 1;
}



/*
message KeyPathname {

    // The parent community and domain in question
                KeyPath         path                    = 1;

    // The key's public name (for asysmmetric keys, the public key)
                bytes           pub_key                 = 2;


}



message KeyRepo {

                KeyPath         key_path                = 1;


   // repeated    map<string, 
     //               bytes>      op_args                 = 3;

}




*/